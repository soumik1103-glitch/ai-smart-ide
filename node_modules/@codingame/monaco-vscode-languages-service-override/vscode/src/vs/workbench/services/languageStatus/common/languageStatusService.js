
import { Event } from '@codingame/monaco-vscode-api/vscode/vs/base/common/event';
import { compare } from '@codingame/monaco-vscode-api/vscode/vs/base/common/strings';
import { LanguageFeatureRegistry } from '@codingame/monaco-vscode-api/vscode/vs/editor/common/languageFeatureRegistry';
import '@codingame/monaco-vscode-api/vscode/vs/platform/instantiation/common/extensions';
import '@codingame/monaco-vscode-api/vscode/vs/platform/instantiation/common/instantiation';

class LanguageStatusServiceImpl {
    constructor() {
        this._provider = ( new LanguageFeatureRegistry());
        this.onDidChange = ( Event.map(this._provider.onDidChange, () => undefined));
    }
    addStatus(status) {
        return this._provider.register(status.selector, status);
    }
    getLanguageStatus(model) {
        return this._provider.ordered(model).sort((a, b) => {
            let res = b.severity - a.severity;
            if (res === 0) {
                res = compare(a.source, b.source);
            }
            if (res === 0) {
                res = compare(a.id, b.id);
            }
            return res;
        });
    }
}

export { LanguageStatusServiceImpl };
