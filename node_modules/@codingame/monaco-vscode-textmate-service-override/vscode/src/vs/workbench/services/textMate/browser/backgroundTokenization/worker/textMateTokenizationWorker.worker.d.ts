import { UriComponents } from "@codingame/monaco-vscode-api/vscode/vs/base/common/uri";
import { LanguageId } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/encodedTokenAttributes";
import { IModelChangedEvent } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/model/mirrorTextModel";
import { IValidEmbeddedLanguagesMap, IValidTokenTypeMap } from "../../../common/TMScopeRegistry.js";
import type { IRawTheme, StackDiff } from "@codingame/monaco-vscode-api/_virtual/main";
import { IWebWorkerServerRequestHandler, IWebWorkerServer } from "@codingame/monaco-vscode-api/vscode/vs/base/common/worker/webWorker";
export declare function create(workerServer: IWebWorkerServer): TextMateTokenizationWorker;
export interface ICreateData {
    grammarDefinitions: IValidGrammarDefinitionDTO[];
    onigurumaWASMUri: string;
}
export interface IValidGrammarDefinitionDTO {
    location: UriComponents;
    language?: string;
    scopeName: string;
    embeddedLanguages: IValidEmbeddedLanguagesMap;
    tokenTypes: IValidTokenTypeMap;
    injectTo?: string[];
    balancedBracketSelectors: string[];
    unbalancedBracketSelectors: string[];
    sourceExtensionId?: string;
}
export interface StateDeltas {
    startLineNumber: number;
    stateDeltas: (StackDiff | null)[];
}
export declare class TextMateTokenizationWorker implements IWebWorkerServerRequestHandler {
    _requestHandlerBrand: void;
    private readonly _host;
    private readonly _models;
    private readonly _grammarCache;
    private _grammarFactory;
    constructor(workerServer: IWebWorkerServer);
    $init(_createData: ICreateData): Promise<void>;
    private _loadTMGrammarFactory;
    $acceptNewModel(data: IRawModelData): void;
    $acceptModelChanged(controllerId: number, e: IModelChangedEvent): void;
    $retokenize(controllerId: number, startLineNumber: number, endLineNumberExclusive: number): void;
    $acceptModelLanguageChanged(controllerId: number, newLanguageId: string, newEncodedLanguageId: LanguageId): void;
    $acceptRemovedModel(controllerId: number): void;
    $acceptTheme(theme: IRawTheme, colorMap: string[]): Promise<void>;
    $acceptMaxTokenizationLineLength(controllerId: number, value: number): void;
}
export interface IRawModelData {
    uri: UriComponents;
    versionId: number;
    lines: string[];
    EOL: string;
    languageId: string;
    encodedLanguageId: LanguageId;
    maxTokenizationLineLength: number;
    controllerId: number;
}
