import { Disposable } from "../../../../base/common/lifecycle.js";
import { IObservable } from "../../../../base/common/observable.js";
import { URI } from "../../../../base/common/uri.js";
import { IOffsetRange } from "../../../../editor/common/core/ranges/offsetRange.js";
import { IConfigurationService } from "../../../../platform/configuration/common/configuration.service.js";
import { IContextKeyService } from "../../../../platform/contextkey/common/contextkey.service.js";
import { ILogService } from "../../../../platform/log/common/log.service.js";
import { IStorageService } from "../../../../platform/storage/common/storage.service.js";
import { IChatAgentService } from "./participants/chatAgents.service.js";
import { ChatModeKind } from "./constants.js";
import { IHandOff } from "./promptSyntax/promptFileParser.js";
import { ExtensionAgentSourceType, IAgentSource, ICustomAgent, PromptsStorage } from "./promptSyntax/service/promptsService.js";
import { IPromptsService } from "./promptSyntax/service/promptsService.service.js";
import { IChatModeService } from "./chatModes.service.js";
export declare class ChatModeService extends Disposable implements IChatModeService {
    private readonly promptsService;
    private readonly chatAgentService;
    private readonly logService;
    private readonly storageService;
    private readonly configurationService;
    readonly _serviceBrand: undefined;
    private static readonly CUSTOM_MODES_STORAGE_KEY;
    private readonly hasCustomModes;
    private readonly agentModeDisabledByPolicy;
    private readonly _customModeInstances;
    private readonly _onDidChangeChatModes;
    readonly onDidChangeChatModes: import("../../../../base/common/event.js").Event<void>;
    constructor(promptsService: IPromptsService, chatAgentService: IChatAgentService, contextKeyService: IContextKeyService, logService: ILogService, storageService: IStorageService, configurationService: IConfigurationService);
    private loadCachedModes;
    private deserializeCachedModes;
    private saveCachedModes;
    private refreshCustomPromptModes;
    getModes(): {
        builtin: readonly IChatMode[];
        custom: readonly IChatMode[];
    };
    findModeById(id: string | ChatModeKind): IChatMode | undefined;
    findModeByName(name: string): IChatMode | undefined;
    private getBuiltinModes;
    private getCustomModes;
    private updateAgentModePolicyContextKey;
    private isAgentModeDisabledByPolicy;
}
export interface IChatModeData {
    readonly id: string;
    readonly name: string;
    readonly description?: string;
    readonly kind: ChatModeKind;
    readonly customTools?: readonly string[];
    readonly model?: string;
    readonly argumentHint?: string;
    readonly modeInstructions?: IChatModeInstructions;
    readonly body?: string;
    readonly handOffs?: readonly IHandOff[];
    readonly uri?: URI;
    readonly source?: IChatModeSourceData;
    readonly target?: string;
    readonly infer?: boolean;
}
export interface IChatMode {
    readonly id: string;
    readonly name: IObservable<string>;
    readonly label: IObservable<string>;
    readonly description: IObservable<string | undefined>;
    readonly isBuiltin: boolean;
    readonly kind: ChatModeKind;
    readonly customTools?: IObservable<readonly string[] | undefined>;
    readonly handOffs?: IObservable<readonly IHandOff[] | undefined>;
    readonly model?: IObservable<string | undefined>;
    readonly argumentHint?: IObservable<string | undefined>;
    readonly modeInstructions?: IObservable<IChatModeInstructions>;
    readonly uri?: IObservable<URI>;
    readonly source?: IAgentSource;
    readonly target?: IObservable<string | undefined>;
    readonly infer?: IObservable<boolean | undefined>;
}
export interface IVariableReference {
    readonly name: string;
    readonly range: IOffsetRange;
}
export interface IChatModeInstructions {
    readonly content: string;
    readonly toolReferences: readonly IVariableReference[];
    readonly metadata?: Record<string, boolean | string | number>;
}
export declare class CustomChatMode implements IChatMode {
    private readonly _nameObservable;
    private readonly _descriptionObservable;
    private readonly _customToolsObservable;
    private readonly _modeInstructions;
    private readonly _uriObservable;
    private readonly _modelObservable;
    private readonly _argumentHintObservable;
    private readonly _handoffsObservable;
    private readonly _targetObservable;
    private readonly _inferObservable;
    private _source;
    readonly id: string;
    get name(): IObservable<string>;
    get description(): IObservable<string | undefined>;
    get isBuiltin(): boolean;
    get customTools(): IObservable<readonly string[] | undefined>;
    get model(): IObservable<string | undefined>;
    get argumentHint(): IObservable<string | undefined>;
    get modeInstructions(): IObservable<IChatModeInstructions>;
    get uri(): IObservable<URI>;
    get label(): IObservable<string>;
    get handOffs(): IObservable<readonly IHandOff[] | undefined>;
    get source(): IAgentSource;
    get target(): IObservable<string | undefined>;
    get infer(): IObservable<boolean | undefined>;
    readonly kind = ChatModeKind.Agent;
    constructor(customChatMode: ICustomAgent);
    /**
     * Updates the underlying data and triggers observable changes
     */
    updateData(newData: ICustomAgent): void;
    toJSON(): IChatModeData;
}
type IChatModeSourceData = {
    readonly storage: PromptsStorage.extension;
    readonly extensionId: string;
    type?: ExtensionAgentSourceType;
} | {
    readonly storage: PromptsStorage.local | PromptsStorage.user;
};
export declare class BuiltinChatMode implements IChatMode {
    readonly kind: ChatModeKind;
    readonly name: IObservable<string>;
    readonly label: IObservable<string>;
    readonly description: IObservable<string>;
    constructor(kind: ChatModeKind, label: string, description: string);
    get isBuiltin(): boolean;
    get id(): string;
    get target(): IObservable<string | undefined>;
    /**
     * Getters are not json-stringified
     */
    toJSON(): IChatModeData;
}
export declare namespace ChatMode {
    const Ask: BuiltinChatMode;
    const Edit: BuiltinChatMode;
    const Agent: BuiltinChatMode;
}
export declare function isBuiltinChatMode(mode: IChatMode): boolean;
export {};
