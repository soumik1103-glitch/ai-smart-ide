
import { dirname, basename } from '../../../../../../base/common/path.js';
import { PromptsType } from '../promptTypes.js';

const PROMPT_FILE_EXTENSION = '.prompt.md';
const INSTRUCTION_FILE_EXTENSION = '.instructions.md';
const LEGACY_MODE_FILE_EXTENSION = '.chatmode.md';
const AGENT_FILE_EXTENSION = '.agent.md';
const COPILOT_CUSTOM_INSTRUCTIONS_FILENAME = 'copilot-instructions.md';
const PROMPT_DEFAULT_SOURCE_FOLDER = '.github/prompts';
const INSTRUCTIONS_DEFAULT_SOURCE_FOLDER = '.github/instructions';
const LEGACY_MODE_DEFAULT_SOURCE_FOLDER = '.github/chatmodes';
const AGENTS_SOURCE_FOLDER = '.github/agents';
const DEFAULT_AGENT_SKILLS_WORKSPACE_FOLDERS = [
    { path: '.github/skills', type: 'github-workspace' },
    { path: '.claude/skills', type: 'claude-workspace' }
];
const DEFAULT_AGENT_SKILLS_USER_HOME_FOLDERS = [
    { path: '.copilot/skills', type: 'copilot-personal' },
    { path: '.claude/skills', type: 'claude-personal' }
];
function isInAgentsFolder(fileUri) {
    const dir = dirname(fileUri.path);
    return dir.endsWith('/' + AGENTS_SOURCE_FOLDER) || dir === AGENTS_SOURCE_FOLDER;
}
function getPromptFileType(fileUri) {
    const filename = basename(fileUri.path);
    if (filename.endsWith(PROMPT_FILE_EXTENSION)) {
        return PromptsType.prompt;
    }
    if (filename.endsWith(INSTRUCTION_FILE_EXTENSION) || (filename === COPILOT_CUSTOM_INSTRUCTIONS_FILENAME)) {
        return PromptsType.instructions;
    }
    if (filename.endsWith(LEGACY_MODE_FILE_EXTENSION) || filename.endsWith(AGENT_FILE_EXTENSION)) {
        return PromptsType.agent;
    }
    if (filename.endsWith('.md') && isInAgentsFolder(fileUri)) {
        return PromptsType.agent;
    }
    return undefined;
}
function isPromptOrInstructionsFile(fileUri) {
    return getPromptFileType(fileUri) !== undefined;
}
function getPromptFileExtension(type) {
    switch (type) {
        case PromptsType.instructions:
            return INSTRUCTION_FILE_EXTENSION;
        case PromptsType.prompt:
            return PROMPT_FILE_EXTENSION;
        case PromptsType.agent:
            return AGENT_FILE_EXTENSION;
        default:
            throw ( new Error('Unknown prompt type'));
    }
}
function getPromptFileDefaultLocation(type) {
    switch (type) {
        case PromptsType.instructions:
            return INSTRUCTIONS_DEFAULT_SOURCE_FOLDER;
        case PromptsType.prompt:
            return PROMPT_DEFAULT_SOURCE_FOLDER;
        case PromptsType.agent:
            return AGENTS_SOURCE_FOLDER;
        default:
            throw ( new Error('Unknown prompt type'));
    }
}
function getCleanPromptName(fileUri) {
    const fileName = basename(fileUri.path);
    const extensions = [
        PROMPT_FILE_EXTENSION,
        INSTRUCTION_FILE_EXTENSION,
        LEGACY_MODE_FILE_EXTENSION,
        AGENT_FILE_EXTENSION,
    ];
    for (const ext of extensions) {
        if (fileName.endsWith(ext)) {
            return basename(fileUri.path, ext);
        }
    }
    if (fileName === COPILOT_CUSTOM_INSTRUCTIONS_FILENAME) {
        return basename(fileUri.path, '.md');
    }
    if (fileName.endsWith('.md') && isInAgentsFolder(fileUri)) {
        return basename(fileUri.path, '.md');
    }
    return basename(fileUri.path);
}

export { AGENTS_SOURCE_FOLDER, AGENT_FILE_EXTENSION, COPILOT_CUSTOM_INSTRUCTIONS_FILENAME, DEFAULT_AGENT_SKILLS_USER_HOME_FOLDERS, DEFAULT_AGENT_SKILLS_WORKSPACE_FOLDERS, INSTRUCTIONS_DEFAULT_SOURCE_FOLDER, INSTRUCTION_FILE_EXTENSION, LEGACY_MODE_DEFAULT_SOURCE_FOLDER, LEGACY_MODE_FILE_EXTENSION, PROMPT_DEFAULT_SOURCE_FOLDER, PROMPT_FILE_EXTENSION, getCleanPromptName, getPromptFileDefaultLocation, getPromptFileExtension, getPromptFileType, isPromptOrInstructionsFile };
