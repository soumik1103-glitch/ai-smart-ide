import { CancellationToken } from "../../../../base/common/cancellation.js";
import { Event } from "../../../../base/common/event.js";
import { IMarkdownString } from "../../../../base/common/htmlContent.js";
import { IDisposable } from "../../../../base/common/lifecycle.js";
import { IObservable } from "../../../../base/common/observable.js";
import { ThemeIcon } from "../../../../base/common/themables.js";
import { URI } from "../../../../base/common/uri.js";
import { IChatAgentAttachmentCapabilities, IChatAgentRequest } from "./participants/chatAgents.js";
import { IChatEditingSession } from "./editing/chatEditingService.js";
import { IChatRequestVariableData, ISerializableChatModelInputState } from "./model/chatModel.js";
import { IChatProgress } from "./chatService/chatService.js";
export declare enum ChatSessionStatus {
    Failed = 0,
    Completed = 1,
    InProgress = 2,
    NeedsInput = 3
}
export interface IChatSessionCommandContribution {
    name: string;
    description: string;
    when?: string;
}
export interface IChatSessionProviderOptionItem {
    id: string;
    name: string;
    description?: string;
    locked?: boolean;
    icon?: ThemeIcon;
}
export interface IChatSessionProviderOptionGroup {
    id: string;
    name: string;
    description?: string;
    items: IChatSessionProviderOptionItem[];
    /**
     * A context key expression that controls visibility of this option group picker.
     * When specified, the picker is only visible when the expression evaluates to true.
     * The expression can reference other option group values via `chatSessionOption.<groupId>`.
     * Example: `"chatSessionOption.models == 'gpt-4'"`
     */
    when?: string;
}
export interface IChatSessionsExtensionPoint {
    readonly type: string;
    readonly name: string;
    readonly displayName: string;
    readonly description: string;
    readonly when?: string;
    readonly icon?: string | {
        light: string;
        dark: string;
    };
    readonly order?: number;
    readonly alternativeIds?: string[];
    readonly welcomeTitle?: string;
    readonly welcomeMessage?: string;
    readonly welcomeTips?: string;
    readonly inputPlaceholder?: string;
    readonly capabilities?: IChatAgentAttachmentCapabilities;
    readonly commands?: IChatSessionCommandContribution[];
    readonly canDelegate?: boolean;
}
export interface IChatSessionItem {
    resource: URI;
    label: string;
    iconPath?: ThemeIcon;
    badge?: string | IMarkdownString;
    description?: string | IMarkdownString;
    status?: ChatSessionStatus;
    tooltip?: string | IMarkdownString;
    timing: {
        startTime: number;
        endTime?: number;
    };
    changes?: {
        files: number;
        insertions: number;
        deletions: number;
    } | readonly IChatSessionFileChange[];
    archived?: boolean;
}
export interface IChatSessionFileChange {
    modifiedUri: URI;
    originalUri?: URI;
    insertions: number;
    deletions: number;
}
export type IChatSessionHistoryItem = {
    id?: string;
    type: "request";
    prompt: string;
    participant: string;
    command?: string;
    variableData?: IChatRequestVariableData;
} | {
    type: "response";
    parts: IChatProgress[];
    participant: string;
};
/**
 * The session type used for local agent chat sessions.
 */
export declare const localChatSessionType = "local";
export interface IChatSession extends IDisposable {
    readonly onWillDispose: Event<void>;
    readonly sessionResource: URI;
    readonly history: readonly IChatSessionHistoryItem[];
    /**
     * Session options as key-value pairs. Keys correspond to option group IDs (e.g., 'models', 'subagents')
     * and values are either the selected option item IDs (string) or full option items (for locked state).
     */
    readonly options?: Record<string, string | IChatSessionProviderOptionItem>;
    readonly progressObs?: IObservable<IChatProgress[]>;
    readonly isCompleteObs?: IObservable<boolean>;
    readonly interruptActiveResponseCallback?: () => Promise<boolean>;
    /**
     * Editing session transferred from a previously-untitled chat session in `onDidCommitChatSessionItem`.
     */
    transferredState?: {
        editingSession: IChatEditingSession | undefined;
        inputState: ISerializableChatModelInputState | undefined;
    };
    requestHandler?: (request: IChatAgentRequest, progress: (progress: IChatProgress[]) => void, history: any[], // TODO: Nail down types
    token: CancellationToken) => Promise<void>;
}
export interface IChatSessionItemProvider {
    readonly chatSessionType: string;
    readonly onDidChangeChatSessionItems: Event<void>;
    provideChatSessionItems(token: CancellationToken): Promise<IChatSessionItem[]>;
}
export interface IChatSessionContentProvider {
    provideChatSessionContent(sessionResource: URI, token: CancellationToken): Promise<IChatSession>;
}
export type SessionOptionsChangedCallback = (sessionResource: URI, updates: ReadonlyArray<{
    optionId: string;
    value: string | IChatSessionProviderOptionItem;
}>) => Promise<void>;
export declare function isSessionInProgressStatus(state: ChatSessionStatus): boolean;
