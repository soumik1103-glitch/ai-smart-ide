import { Event } from "../../../../../base/common/event.js";
import { IMarkdownString } from "../../../../../base/common/htmlContent.js";
import { Disposable } from "../../../../../base/common/lifecycle.js";
import { MarshalledId } from "../../../../../base/common/marshallingIds.js";
import { ThemeIcon } from "../../../../../base/common/themables.js";
import { URI } from "../../../../../base/common/uri.js";
import { IInstantiationService } from "../../../../../platform/instantiation/common/instantiation.js";
import { ILogService } from "../../../../../platform/log/common/log.service.js";
import { IStorageService } from "../../../../../platform/storage/common/storage.service.js";
import { ILifecycleService } from "../../../../services/lifecycle/common/lifecycle.service.js";
import { ChatSessionStatus as AgentSessionStatus, IChatSessionItem } from "../../common/chatSessionsService.js";
import { IChatSessionsService } from "../../common/chatSessionsService.service.js";
export { ChatSessionStatus as AgentSessionStatus } from "../../common/chatSessionsService.js";
export { isSessionInProgressStatus } from "../../common/chatSessionsService.js";
export interface IAgentSessionsModel {
    readonly onWillResolve: Event<void>;
    readonly onDidResolve: Event<void>;
    readonly onDidChangeSessions: Event<void>;
    readonly sessions: IAgentSession[];
    getSession(resource: URI): IAgentSession | undefined;
    resolve(provider: string | string[] | undefined): Promise<void>;
}
interface IAgentSessionData extends Omit<IChatSessionItem, "archived" | "iconPath"> {
    readonly providerType: string;
    readonly providerLabel: string;
    readonly resource: URI;
    readonly status: AgentSessionStatus;
    readonly tooltip?: string | IMarkdownString;
    readonly label: string;
    readonly description?: string | IMarkdownString;
    readonly badge?: string | IMarkdownString;
    readonly icon: ThemeIcon;
    readonly timing: IChatSessionItem["timing"] & {
        readonly inProgressTime?: number;
        readonly finishedOrFailedTime?: number;
    };
    readonly changes?: IChatSessionItem["changes"];
}
/**
 * Checks if the provided changes object represents valid diff information.
 */
export declare function hasValidDiff(changes: IAgentSession["changes"]): boolean;
/**
 * Gets a summary of agent session changes, converting from array format to object format if needed.
 */
export declare function getAgentChangesSummary(changes: IAgentSession["changes"]): {
    files: number;
    insertions: number;
    deletions: number;
} | undefined;
export interface IAgentSession extends IAgentSessionData {
    isArchived(): boolean;
    setArchived(archived: boolean): void;
    isRead(): boolean;
    setRead(read: boolean): void;
}
export declare function isLocalAgentSessionItem(session: IAgentSession): boolean;
export declare function isAgentSession(obj: unknown): obj is IAgentSession;
export declare function isAgentSessionsModel(obj: unknown): obj is IAgentSessionsModel;
export declare enum AgentSessionSection {
    InProgress = "inProgress",
    Today = "today",
    Yesterday = "yesterday",
    Week = "week",
    Older = "older",
    Archived = "archived"
}
export interface IAgentSessionSection {
    readonly section: AgentSessionSection;
    readonly label: string;
    readonly sessions: IAgentSession[];
}
export declare function isAgentSessionSection(obj: IAgentSessionsModel | IAgentSession | IAgentSessionSection): obj is IAgentSessionSection;
export interface IMarshalledAgentSessionContext {
    readonly $mid: MarshalledId.AgentSessionContext;
    readonly session: IAgentSession;
}
export declare function isMarshalledAgentSessionContext(thing: unknown): thing is IMarshalledAgentSessionContext;
export declare class AgentSessionsModel extends Disposable implements IAgentSessionsModel {
    private readonly chatSessionsService;
    private readonly lifecycleService;
    private readonly instantiationService;
    private readonly storageService;
    private readonly logService;
    private readonly _onWillResolve;
    readonly onWillResolve: Event<void>;
    private readonly _onDidResolve;
    readonly onDidResolve: Event<void>;
    private readonly _onDidChangeSessions;
    readonly onDidChangeSessions: Event<void>;
    private _sessions;
    get sessions(): IAgentSession[];
    private readonly resolver;
    private readonly providersToResolve;
    private readonly mapSessionToState;
    private readonly cache;
    constructor(chatSessionsService: IChatSessionsService, lifecycleService: ILifecycleService, instantiationService: IInstantiationService, storageService: IStorageService, logService: ILogService);
    private registerListeners;
    getSession(resource: URI): IAgentSession | undefined;
    resolve(provider: string | string[] | undefined): Promise<void>;
    private doResolve;
    private toAgentSession;
    private static readonly READ_STATE_INITIAL_DATE;
    private readonly sessionStates;
    private isArchived;
    private setArchived;
    private isRead;
    private setRead;
}
